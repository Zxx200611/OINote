有一条由 $n$​ 条轨道所组成的铁路。其中轨道编号为 $1$​ 至 $n$​，第 $i$​ 条轨道连接第 $i-1$​ 和第 $i$​​ 个站点。通行第 $i$ 段轨道需要 $t_i$ 单位的时间。某些轨道允许相向列车同时通行，某些不允许。

任何列车总是从第 $0$ 号站点到第 $n$ 号站点，或是从第 $n$ 号站点到第 $0$ 号站点。

铁路公司需要设计一个运营计划，满足：

+ 列车在站点外不停车，即若时刻 $t$ 驶入第 $i$ 条轨道，必须在时刻 $t+t_i$ 到达下一站点。

+ 相邻两辆同向的列车的时间间隔总是为 $k$​​，即设此列车到达第 $i$ 个站点的时间为 $t$，离开的时间为 $t'$，则下一辆同向的列车在第 $t+k$ 时刻到达，在第 $t'+k$​ 时刻离开。
+ 不存在两辆相向列车同时通行一条不允许相向列车同时通行的轨道。
+ 此方案可以永久运行下去。

求是否存在满足条件的运营计划，若存在，设一辆列车按此计划从 $0$​ 站点到 $n$​ 站点所需时间为 $T_a$​，从 $n$​ 站点到 $0$​ 站点所需时间为 $T_b$​，最小化 $T_a + T_b$​。

---

因为所有同向列车的间隔为 $k$，所以总是可以将时间模掉一个 $k$，并不影响。

考虑题目对答案的限制：

+ 允许相向列车同时通行的轨道没有什么特别的限制，可以忽略，将以此类轨道通行的点缩成一个点。注意最后的答案需要算上它们。
+ 不允许相向列车同时通行的轨道对答案有限制。



为了具体地描述限制，定义如下：

+ 一辆从 $0$ 到 $n$ 的列车在第 $i$ 个站点停留 $a_i$ 的时间。
+ 一辆从 $n$ 到 $0$ 的列车在第 $i$ 个站点停留 $b_i$ 的时间。

+ $A_i = \sum_{j=0}^{i} a_j$​，$B_i = \sum_{j=0}^{i} b_j$​，$T_i = \sum_{j=0}^{i} t_i$​​。

则易得：

+ 一辆从 $0$ 到 $n$ 的列车将于时刻 $[T_{i-1} + A_{i-1},T_i + A_{i-1}]$ 行驶在第 $i$ 条轨道上。
+ 一辆从 $n$​ 到 $0$​ 的列车将于时刻 $[,]$​ 行驶在第 $i$​ 条轨道上。