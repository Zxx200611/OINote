给出一个仅包含 $a$，$b$ 两个字符的字符串 $s$。

求 $s$ 的不连续回文子序列个数。

---

不连续比较难搞，但是发现只需要用所有符合回文的子序列数减掉回文子串数即是答案，而回文子串数可以用 Manacher $O(n)$ 求出，所以问题转化为求出回文子序列数。

设关于位置 $i$​ （$i$ 也可以是小数，表示关于中间的缝对称）对称的字符对数为 $f(i)$，易得关于位置 $i$ 对称的回文子序列数为 $2^{f(i)}$。问题就转化为求 $f(i)$​。

可以发现：
$$
f(i) = \sum_{j=1}^{2i} [s_j = s_{2i-j}]
$$
若将 $a$ 设置为 $1$，$b$ 设置为 $0$，则有：
$$
f_a(i) = \sum_{j=1}^{2i} s_j \times s_{2i-j}
$$
$b$ 的也差不多。

则：将某种字符设定为 $1$，其他为 $0$，得到式子 $s_0+s_1x+ \dots + s_{2n+1}$，则关于 $i$ 对称的这种字符数为原式子的平方在 $2i$ 次的系数除以 $2$。

设 Manacher 求出的回文子串数为 $cnt$，问题的答案为：
$$
\sum_{i=1}^{2n+1} 2^{f_a(i)+f_b(i)} - cnt
$$
