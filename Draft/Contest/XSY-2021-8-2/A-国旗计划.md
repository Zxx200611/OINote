有一个长度为 $m$ 的环，上面有 $n$ 条不互相包含的线段 $L_1 \dots :L_n$。

对于每一条线段，求若此线段必选，最少需要选择多少线段使得环被完全覆盖。

---

首先断环成链，注意没有跨过 $m$​ 的区间要再右边复制两遍，跨过 $m$ 的要复制一遍，因为它们在右区间依然能用来转移。

发现对于线段 $i$​ 答案就是从 $L_i$​ 的左端点开始，选择尽量少的线段将已覆盖范围扩充到大于 $L_i$​ 的左端点加 $m$​。

从贪心的方面考虑，每条线段的下一条线段是固定的，也就是左端点被此线段包含，右端点尽量靠右的那一条，称其为此线段的最优转移线段。由于已经断环成链，在将所有线段按左端点排序后可以使用双指针快速预处理出。

那么只需要对排序后的每条线段 $i$​ 不停地往后跳最优转移线段，跳到第一条 $j$​ 满足 $L_i$​ 的左端点到 $L_j$​ 的右端点距离大于等于 $m$​ 即可，答案为 $j-i+1$​​。

如果这么做，还是 $O(n^2)$​ 的，无法通过。



但是发现可以倍增：记 $i$ 往后跳 $2^j$​ 条最优转移线段，跳到的线段编号为 $f[i][j]$。

对于第 $i$ 条线段，倍增地向后跳，找到距离 $m$ 最近的那一条 $j$，答案为倍增时跳过的线段数。可以发现复制的线段不会对答案产生影响。



经验：

+ 对于环，断环成链是一个很重要的 Trick，应该要尽快想到。
+ 对于这种向后跳直到满足条件的题，可以往倍增上想。