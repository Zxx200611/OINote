给出一棵基环外向树，每个点 $i$ 有一个权值 $a_i$，求是否存在一种分配 $a_i$ 的方案，满足以下条件：

+ 所有 $a_i$​​ 是非负整数。
+ 对于一个节点 $i$，$a_i$ 是 $i$ 这个节点指向的所有节点的 $a$ 的 $\operatorname{mex}$。

---

首先，发现对于一棵树的情况，$a$ 是存在且确定的。

那么可以对环上每个点算出它只考虑其子树的 $a$，记作 $a'$。

那么有环和无环有什么不同呢？

对于原基环树中的环，每个点 $i$​​ 还有一条指向环上下一个点 $j$​​ 的边 $i \rightarrow j$​。

现在看来，若此环的 $a$​​ 不是全部相同，将一个环上的某一个最小值的位置 $p$​ 固定下来（若有连续的一段最小值，则固定第一个），逆着环上的边处理依次这个环即可，发现是一定可行的。

若此环的 $a$ 全部相同，则若此环是偶环，可以交错地将 $a$ 加 $1$，这样是可行的。但若此环是奇环就没有方案了。

综上得到结论：当基环的 $a'$ 全部相等，且环是一个奇环时没有方案，其他都有。



经验：

+ $n$ 个点，只有 $n$ 条边的弱连通图是基环树。
+ 基环树分别考虑树和环的情况，再拼起来。